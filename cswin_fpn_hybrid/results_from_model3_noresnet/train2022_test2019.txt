For mac gpu available:  False
For windows gpu available:  True
Using device: cuda
Total Trainable params: 22,597,058 / 22,597,058
CSWin Stage 1 Trainable params: 50,624
CSWin Stage 2 Trainable params: 399,104
CSWin Stage 3 Trainable params: 16,638,720
CSWin Stage 4 Trainable params: 3,157,504
Head Classifier Trainable params: 1,026
[Epoch 1, Step 20] Loss: 0.221
[Epoch 2, Step 20] Loss: 0.196
[Epoch 3, Step 20] Loss: 0.179
[Epoch 4, Step 20] Loss: 0.167
[Epoch 5, Step 20] Loss: 0.165
[Epoch 6, Step 20] Loss: 0.167
[Epoch 7, Step 20] Loss: 0.162
[Epoch 8, Step 20] Loss: 0.170
[Epoch 9, Step 20] Loss: 0.164
[Epoch 10, Step 20] Loss: 0.159
[Epoch 11, Step 20] Loss: 0.157
[Epoch 12, Step 20] Loss: 0.154
[Epoch 13, Step 20] Loss: 0.153
[Epoch 14, Step 20] Loss: 0.156
[Epoch 15, Step 20] Loss: 0.154
[Epoch 16, Step 20] Loss: 0.153
[Epoch 17, Step 20] Loss: 0.150
[Epoch 18, Step 20] Loss: 0.150
[Epoch 19, Step 20] Loss: 0.151
[Epoch 20, Step 20] Loss: 0.149
[Epoch 21, Step 20] Loss: 0.150
[Epoch 22, Step 20] Loss: 0.152
[Epoch 23, Step 20] Loss: 0.149
[Epoch 24, Step 20] Loss: 0.149
[Epoch 25, Step 20] Loss: 0.148
[Epoch 26, Step 20] Loss: 0.152
[Epoch 27, Step 20] Loss: 0.146
[Epoch 28, Step 20] Loss: 0.150
[Epoch 29, Step 20] Loss: 0.146
[Epoch 30, Step 20] Loss: 0.148
[Epoch 31, Step 20] Loss: 0.149
[Epoch 32, Step 20] Loss: 0.146
[Epoch 33, Step 20] Loss: 0.147
[Epoch 34, Step 20] Loss: 0.148
[Epoch 35, Step 20] Loss: 0.148
[Epoch 36, Step 20] Loss: 0.147
[Epoch 37, Step 20] Loss: 0.146
[Epoch 38, Step 20] Loss: 0.147
[Epoch 39, Step 20] Loss: 0.147
[Epoch 40, Step 20] Loss: 0.145
[Epoch 41, Step 20] Loss: 0.147
[Epoch 42, Step 20] Loss: 0.147
[Epoch 43, Step 20] Loss: 0.146
[Epoch 44, Step 20] Loss: 0.147
[Epoch 45, Step 20] Loss: 0.146
[Epoch 46, Step 20] Loss: 0.147
[Epoch 47, Step 20] Loss: 0.146
[Epoch 48, Step 20] Loss: 0.145
[Epoch 49, Step 20] Loss: 0.147
[Epoch 50, Step 20] Loss: 0.146
[Epoch 51, Step 20] Loss: 0.146
[Epoch 52, Step 20] Loss: 0.147
[Epoch 53, Step 20] Loss: 0.144
[Epoch 54, Step 20] Loss: 0.145
[Epoch 55, Step 20] Loss: 0.147
[Epoch 56, Step 20] Loss: 0.146
[Epoch 57, Step 20] Loss: 0.147
[Epoch 58, Step 20] Loss: 0.144
[Epoch 59, Step 20] Loss: 0.146
[Epoch 60, Step 20] Loss: 0.143
[Epoch 61, Step 20] Loss: 0.146
[Epoch 62, Step 20] Loss: 0.148
[Epoch 63, Step 20] Loss: 0.143
[Epoch 64, Step 20] Loss: 0.144
[Epoch 65, Step 20] Loss: 0.143
[Epoch 66, Step 20] Loss: 0.143
[Epoch 67, Step 20] Loss: 0.144
[Epoch 68, Step 20] Loss: 0.144
[Epoch 69, Step 20] Loss: 0.144
[Epoch 70, Step 20] Loss: 0.144
[Epoch 71, Step 20] Loss: 0.143
[Epoch 72, Step 20] Loss: 0.144
[Epoch 73, Step 20] Loss: 0.143
[Epoch 74, Step 20] Loss: 0.144
[Epoch 75, Step 20] Loss: 0.145
[Epoch 76, Step 20] Loss: 0.145
[Epoch 77, Step 20] Loss: 0.143
[Epoch 78, Step 20] Loss: 0.144
[Epoch 79, Step 20] Loss: 0.142
[Epoch 80, Step 20] Loss: 0.145
[Epoch 81, Step 20] Loss: 0.145
[Epoch 82, Step 20] Loss: 0.144
[Epoch 83, Step 20] Loss: 0.144
[Epoch 84, Step 20] Loss: 0.144
[Epoch 85, Step 20] Loss: 0.143
[Epoch 86, Step 20] Loss: 0.141
[Epoch 87, Step 20] Loss: 0.143
[Epoch 88, Step 20] Loss: 0.141
[Epoch 89, Step 20] Loss: 0.143
[Epoch 90, Step 20] Loss: 0.144
[Epoch 91, Step 20] Loss: 0.144
[Epoch 92, Step 20] Loss: 0.142
[Epoch 93, Step 20] Loss: 0.146
[Epoch 94, Step 20] Loss: 0.143
[Epoch 95, Step 20] Loss: 0.143
[Epoch 96, Step 20] Loss: 0.143
[Epoch 97, Step 20] Loss: 0.143
[Epoch 98, Step 20] Loss: 0.143
[Epoch 99, Step 20] Loss: 0.143
[Epoch 100, Step 20] Loss: 0.143

Finding best threshold:
Test Set (4505 images)


Threshold  | Acc      | Prec     | Rec      | F1
-------------------------------------------------------
0.01       | 0.3796   | 0.3796   | 1.0000   | 0.5503
0.03       | 0.3796   | 0.3796   | 1.0000   | 0.5503
0.05       | 0.3796   | 0.3796   | 1.0000   | 0.5503
0.07       | 0.3796   | 0.3796   | 1.0000   | 0.5503
0.09       | 0.3796   | 0.3796   | 1.0000   | 0.5503
0.11       | 0.3796   | 0.3796   | 1.0000   | 0.5503
0.13       | 0.3796   | 0.3796   | 1.0000   | 0.5503
0.15       | 0.3796   | 0.3796   | 1.0000   | 0.5503
0.17       | 0.3796   | 0.3796   | 1.0000   | 0.5503
0.19       | 0.3796   | 0.3796   | 1.0000   | 0.5503
0.21       | 0.3796   | 0.3796   | 1.0000   | 0.5503
0.23       | 0.3796   | 0.3796   | 1.0000   | 0.5503
0.25       | 0.3796   | 0.3796   | 1.0000   | 0.5503
0.27       | 0.3796   | 0.3796   | 1.0000   | 0.5503
0.29       | 0.3796   | 0.3796   | 1.0000   | 0.5503
0.31       | 0.3796   | 0.3796   | 1.0000   | 0.5503
0.33       | 0.3796   | 0.3796   | 1.0000   | 0.5503
0.35       | 0.3796   | 0.3796   | 1.0000   | 0.5503
0.37       | 0.3796   | 0.3796   | 1.0000   | 0.5503
0.39       | 0.3794   | 0.3794   | 0.9994   | 0.5500
0.41       | 0.3789   | 0.3792   | 0.9982   | 0.5496
0.43       | 0.3778   | 0.3785   | 0.9953   | 0.5484
0.45       | 0.3780   | 0.3786   | 0.9953   | 0.5485
0.47       | 0.3780   | 0.3786   | 0.9953   | 0.5485
0.49       | 0.3814   | 0.3793   | 0.9901   | 0.5485
0.51 (*)    | 0.3969   | 0.3823   | 0.9561   | 0.5462
0.53       | 0.4679   | 0.4060   | 0.8673   | 0.5530
0.55       | 0.5478   | 0.4365   | 0.6567   | 0.5244
0.57       | 0.6195   | 0.4988   | 0.4702   | 0.4840
0.59       | 0.6459   | 0.5583   | 0.3222   | 0.4086
0.61       | 0.6557   | 0.6192   | 0.2415   | 0.3475
0.63       | 0.6586   | 0.6861   | 0.1854   | 0.2919
0.65       | 0.6622   | 0.7717   | 0.1561   | 0.2597
0.67       | 0.6613   | 0.8194   | 0.1380   | 0.2362
0.69       | 0.6590   | 0.8718   | 0.1193   | 0.2099
0.71       | 0.6570   | 0.9064   | 0.1076   | 0.1924
0.73       | 0.6548   | 0.9189   | 0.0994   | 0.1794
0.75       | 0.6528   | 0.9294   | 0.0924   | 0.1681
0.77       | 0.6502   | 0.9408   | 0.0836   | 0.1536
0.79       | 0.6473   | 0.9549   | 0.0743   | 0.1378
0.81       | 0.6455   | 0.9669   | 0.0684   | 0.1278
0.83       | 0.6431   | 0.9636   | 0.0620   | 0.1165
0.85       | 0.6417   | 0.9615   | 0.0585   | 0.1103
0.87       | 0.6400   | 0.9583   | 0.0538   | 0.1019
0.89       | 0.6377   | 0.9643   | 0.0474   | 0.0903
0.91       | 0.6360   | 0.9861   | 0.0415   | 0.0797
0.93       | 0.6335   | 1.0000   | 0.0345   | 0.0667
0.95       | 0.6291   | 1.0000   | 0.0228   | 0.0446
-------------------------------------------------------
Default (0.50) row marked (*)
Optimal (best F1) threshold: 0.53 | F1: 0.5530

Optimal Threshold: 0.53

Evaluating model at best thershold:
Threshold: 0.53 | Acc: 0.4679 | Prec(+): 0.4060 | Rec(+): 0.8673 | F1(+): 0.5530 | F1-macro: 0.4479

Evaluating model at default threshold (0.5):
Threshold: 0.50 | Acc: 0.3867 | Prec(+): 0.3806 | Rec(+): 0.9819 | F1(+): 0.5486 | F1-macro: 0.2961