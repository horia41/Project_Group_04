For mac gpu available:  False
For windows gpu available:  True
Using device: cuda
Total Trainable params: 24,440,066 / 24,440,066
ResNet50 params: 1,444,928
CSWin Stage 1 Trainable params: 50,624
CSWin Stage 2 Trainable params: 399,104
CSWin Stage 3 Trainable params: 16,638,720
CSWin Stage 4 Trainable params: 3,157,504
Head Classifier Trainable params: 1,026
Bridge Trainable params: 131,584
[Epoch 1, Step 20] Loss: 0.186
[Epoch 2, Step 20] Loss: 0.174
[Epoch 3, Step 20] Loss: 0.159
[Epoch 4, Step 20] Loss: 0.149
[Epoch 5, Step 20] Loss: 0.156
[Epoch 6, Step 20] Loss: 0.134
[Epoch 7, Step 20] Loss: 0.130
[Epoch 8, Step 20] Loss: 0.123
[Epoch 9, Step 20] Loss: 0.124
[Epoch 10, Step 20] Loss: 0.110
[Epoch 11, Step 20] Loss: 0.107
[Epoch 12, Step 20] Loss: 0.100
[Epoch 13, Step 20] Loss: 0.090
[Epoch 14, Step 20] Loss: 0.087
[Epoch 15, Step 20] Loss: 0.093
[Epoch 16, Step 20] Loss: 0.075
[Epoch 17, Step 20] Loss: 0.076
[Epoch 18, Step 20] Loss: 0.070
[Epoch 19, Step 20] Loss: 0.065
[Epoch 20, Step 20] Loss: 0.066
[Epoch 21, Step 20] Loss: 0.064
[Epoch 22, Step 20] Loss: 0.061
[Epoch 23, Step 20] Loss: 0.063
[Epoch 24, Step 20] Loss: 0.056
[Epoch 25, Step 20] Loss: 0.056
[Epoch 26, Step 20] Loss: 0.060
[Epoch 27, Step 20] Loss: 0.056
[Epoch 28, Step 20] Loss: 0.050
[Epoch 29, Step 20] Loss: 0.055
[Epoch 30, Step 20] Loss: 0.052
[Epoch 31, Step 20] Loss: 0.052
[Epoch 32, Step 20] Loss: 0.056
[Epoch 33, Step 20] Loss: 0.054
[Epoch 34, Step 20] Loss: 0.052
[Epoch 35, Step 20] Loss: 0.048
[Epoch 36, Step 20] Loss: 0.048
[Epoch 37, Step 20] Loss: 0.051
[Epoch 38, Step 20] Loss: 0.045
[Epoch 39, Step 20] Loss: 0.047
[Epoch 40, Step 20] Loss: 0.045
[Epoch 41, Step 20] Loss: 0.045
[Epoch 42, Step 20] Loss: 0.044
[Epoch 43, Step 20] Loss: 0.044
[Epoch 44, Step 20] Loss: 0.041
[Epoch 45, Step 20] Loss: 0.040
[Epoch 46, Step 20] Loss: 0.038
[Epoch 47, Step 20] Loss: 0.040
[Epoch 48, Step 20] Loss: 0.042
[Epoch 49, Step 20] Loss: 0.040
[Epoch 50, Step 20] Loss: 0.038
[Epoch 51, Step 20] Loss: 0.040
[Epoch 52, Step 20] Loss: 0.036
[Epoch 53, Step 20] Loss: 0.037
[Epoch 54, Step 20] Loss: 0.035
[Epoch 55, Step 20] Loss: 0.035
[Epoch 56, Step 20] Loss: 0.032
[Epoch 57, Step 20] Loss: 0.044
[Epoch 58, Step 20] Loss: 0.039
[Epoch 59, Step 20] Loss: 0.033
[Epoch 60, Step 20] Loss: 0.034
[Epoch 61, Step 20] Loss: 0.032
[Epoch 62, Step 20] Loss: 0.031
[Epoch 63, Step 20] Loss: 0.033
[Epoch 64, Step 20] Loss: 0.029
[Epoch 65, Step 20] Loss: 0.031
[Epoch 66, Step 20] Loss: 0.030
[Epoch 67, Step 20] Loss: 0.033
[Epoch 68, Step 20] Loss: 0.032
[Epoch 69, Step 20] Loss: 0.028
[Epoch 70, Step 20] Loss: 0.028
[Epoch 71, Step 20] Loss: 0.030
[Epoch 72, Step 20] Loss: 0.027
[Epoch 73, Step 20] Loss: 0.030
[Epoch 74, Step 20] Loss: 0.025
[Epoch 75, Step 20] Loss: 0.025
[Epoch 76, Step 20] Loss: 0.027
[Epoch 77, Step 20] Loss: 0.027
[Epoch 78, Step 20] Loss: 0.029
[Epoch 79, Step 20] Loss: 0.028
[Epoch 80, Step 20] Loss: 0.025
[Epoch 81, Step 20] Loss: 0.025
[Epoch 82, Step 20] Loss: 0.026
[Epoch 83, Step 20] Loss: 0.021
[Epoch 84, Step 20] Loss: 0.026
[Epoch 85, Step 20] Loss: 0.022
[Epoch 86, Step 20] Loss: 0.023
[Epoch 87, Step 20] Loss: 0.028
[Epoch 88, Step 20] Loss: 0.027
[Epoch 89, Step 20] Loss: 0.024
[Epoch 90, Step 20] Loss: 0.025
[Epoch 91, Step 20] Loss: 0.022
[Epoch 92, Step 20] Loss: 0.025
[Epoch 93, Step 20] Loss: 0.023
[Epoch 94, Step 20] Loss: 0.021
[Epoch 95, Step 20] Loss: 0.022
[Epoch 96, Step 20] Loss: 0.023
[Epoch 97, Step 20] Loss: 0.021
[Epoch 98, Step 20] Loss: 0.021
[Epoch 99, Step 20] Loss: 0.024
[Epoch 100, Step 20] Loss: 0.023

Finding best threshold:
Test Set (3157 images)


Threshold  | Acc      | Prec     | Rec      | F1
-------------------------------------------------------
0.01       | 0.6766   | 0.6760   | 1.0000   | 0.8067
0.03       | 0.7637   | 0.7413   | 0.9981   | 0.8507
0.05       | 0.8163   | 0.7890   | 0.9934   | 0.8795
0.07       | 0.8562   | 0.8312   | 0.9873   | 0.9026
0.09       | 0.8761   | 0.8583   | 0.9779   | 0.9142
0.11       | 0.8863   | 0.8776   | 0.9662   | 0.9198
0.13       | 0.8948   | 0.8974   | 0.9531   | 0.9244
0.15       | 0.8964   | 0.9081   | 0.9418   | 0.9246
0.17       | 0.8948   | 0.9166   | 0.9286   | 0.9226
0.19       | 0.8961   | 0.9270   | 0.9183   | 0.9226
0.21       | 0.8933   | 0.9333   | 0.9066   | 0.9197
0.23       | 0.8929   | 0.9436   | 0.8948   | 0.9186
0.25       | 0.8879   | 0.9489   | 0.8812   | 0.9138
0.27       | 0.8828   | 0.9550   | 0.8671   | 0.9090
0.29       | 0.8774   | 0.9560   | 0.8577   | 0.9042
0.31       | 0.8717   | 0.9590   | 0.8460   | 0.8990
0.33       | 0.8660   | 0.9636   | 0.8329   | 0.8935
0.35       | 0.8600   | 0.9668   | 0.8207   | 0.8878
0.37       | 0.8511   | 0.9679   | 0.8061   | 0.8796
0.39       | 0.8435   | 0.9707   | 0.7920   | 0.8723
0.41       | 0.8369   | 0.9736   | 0.7793   | 0.8657
0.43       | 0.8271   | 0.9748   | 0.7634   | 0.8562
0.45       | 0.8191   | 0.9756   | 0.7507   | 0.8485
0.47       | 0.8096   | 0.9775   | 0.7347   | 0.8389
0.49       | 0.7985   | 0.9788   | 0.7169   | 0.8276
0.51 (*)    | 0.7887   | 0.9797   | 0.7014   | 0.8175
0.53       | 0.7805   | 0.9819   | 0.6873   | 0.8086
0.55       | 0.7732   | 0.9829   | 0.6756   | 0.8008
0.57       | 0.7646   | 0.9839   | 0.6620   | 0.7915
0.59       | 0.7542   | 0.9836   | 0.6465   | 0.7802
0.61       | 0.7431   | 0.9846   | 0.6291   | 0.7677
0.63       | 0.7342   | 0.9842   | 0.6160   | 0.7577
0.65       | 0.7235   | 0.9846   | 0.5995   | 0.7453
0.67       | 0.7127   | 0.9849   | 0.5831   | 0.7325
0.69       | 0.6997   | 0.9868   | 0.5624   | 0.7165
0.71       | 0.6855   | 0.9871   | 0.5408   | 0.6988
0.73       | 0.6750   | 0.9894   | 0.5239   | 0.6851
0.75       | 0.6608   | 0.9889   | 0.5028   | 0.6667
0.77       | 0.6433   | 0.9893   | 0.4765   | 0.6432
0.79       | 0.6284   | 0.9898   | 0.4540   | 0.6225
0.81       | 0.6063   | 0.9901   | 0.4207   | 0.5904
0.83       | 0.5857   | 0.9905   | 0.3897   | 0.5593
0.85       | 0.5607   | 0.9934   | 0.3512   | 0.5189
0.87       | 0.5271   | 0.9953   | 0.3005   | 0.4616
0.89       | 0.4910   | 0.9962   | 0.2465   | 0.3952
0.91       | 0.4523   | 0.9975   | 0.1887   | 0.3174
0.93       | 0.4089   | 1.0000   | 0.1239   | 0.2206
0.95       | 0.3659   | 1.0000   | 0.0601   | 0.1134
-------------------------------------------------------
Default (0.50) row marked (*)
Optimal (best F1) threshold: 0.15 | F1: 0.9246

Optimal Threshold: 0.15

Evaluating model at best thershold:
Threshold: 0.15 | Acc: 0.8964 | Prec(+): 0.9081 | Rec(+): 0.9418 | F1(+): 0.9246 | F1-macro: 0.8795

Evaluating model at default threshold (0.5):
Threshold: 0.50 | Acc: 0.7932 | Prec(+): 0.9792 | Rec(+): 0.7085 | F1(+): 0.8221 | F1-macro: 0.7875