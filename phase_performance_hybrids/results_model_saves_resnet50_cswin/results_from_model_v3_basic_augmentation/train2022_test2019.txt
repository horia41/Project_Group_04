Total Trainable params: 24,440,066 / 24,440,066
ResNet50 params: 1,444,928
CSWin Stage 1 Trainable params: 50,624
CSWin Stage 2 Trainable params: 399,104
CSWin Stage 3 Trainable params: 16,638,720
CSWin Stage 4 Trainable params: 3,157,504
Head Classifier Trainable params: 1,026
Bridge Trainable params: 131,584
[Epoch 1, Step 20] Loss: 0.282
[Epoch 2, Step 20] Loss: 0.197
[Epoch 3, Step 20] Loss: 0.163
[Epoch 4, Step 20] Loss: 0.157
[Epoch 5, Step 20] Loss: 0.149
[Epoch 6, Step 20] Loss: 0.152
[Epoch 7, Step 20] Loss: 0.155
[Epoch 8, Step 20] Loss: 0.147
[Epoch 9, Step 20] Loss: 0.144
[Epoch 10, Step 20] Loss: 0.125
[Epoch 11, Step 20] Loss: 0.117
[Epoch 12, Step 20] Loss: 0.113
[Epoch 13, Step 20] Loss: 0.092
[Epoch 14, Step 20] Loss: 0.079
[Epoch 15, Step 20] Loss: 0.072
[Epoch 16, Step 20] Loss: 0.065
[Epoch 17, Step 20] Loss: 0.060
[Epoch 18, Step 20] Loss: 0.053
[Epoch 19, Step 20] Loss: 0.056
[Epoch 20, Step 20] Loss: 0.049
[Epoch 21, Step 20] Loss: 0.047
[Epoch 22, Step 20] Loss: 0.045
[Epoch 23, Step 20] Loss: 0.047
[Epoch 24, Step 20] Loss: 0.045
[Epoch 25, Step 20] Loss: 0.040
[Epoch 26, Step 20] Loss: 0.036
[Epoch 27, Step 20] Loss: 0.039
[Epoch 28, Step 20] Loss: 0.040
[Epoch 29, Step 20] Loss: 0.037
[Epoch 30, Step 20] Loss: 0.040
[Epoch 31, Step 20] Loss: 0.035
[Epoch 32, Step 20] Loss: 0.034
[Epoch 33, Step 20] Loss: 0.031
[Epoch 34, Step 20] Loss: 0.036
[Epoch 35, Step 20] Loss: 0.031
[Epoch 36, Step 20] Loss: 0.027
[Epoch 37, Step 20] Loss: 0.028
[Epoch 38, Step 20] Loss: 0.030
[Epoch 39, Step 20] Loss: 0.024
[Epoch 40, Step 20] Loss: 0.028
[Epoch 41, Step 20] Loss: 0.027
[Epoch 42, Step 20] Loss: 0.029
[Epoch 43, Step 20] Loss: 0.028
[Epoch 44, Step 20] Loss: 0.029
[Epoch 45, Step 20] Loss: 0.022
[Epoch 46, Step 20] Loss: 0.024
[Epoch 47, Step 20] Loss: 0.025
[Epoch 48, Step 20] Loss: 0.026
[Epoch 49, Step 20] Loss: 0.022
[Epoch 50, Step 20] Loss: 0.027
[Epoch 51, Step 20] Loss: 0.022
[Epoch 52, Step 20] Loss: 0.021
[Epoch 53, Step 20] Loss: 0.019
[Epoch 54, Step 20] Loss: 0.019
[Epoch 55, Step 20] Loss: 0.018
[Epoch 56, Step 20] Loss: 0.020
[Epoch 57, Step 20] Loss: 0.018
[Epoch 58, Step 20] Loss: 0.017
[Epoch 59, Step 20] Loss: 0.019
[Epoch 60, Step 20] Loss: 0.017
[Epoch 61, Step 20] Loss: 0.015
[Epoch 62, Step 20] Loss: 0.018
[Epoch 63, Step 20] Loss: 0.018
[Epoch 64, Step 20] Loss: 0.016
[Epoch 65, Step 20] Loss: 0.013
[Epoch 66, Step 20] Loss: 0.017
[Epoch 67, Step 20] Loss: 0.014
[Epoch 68, Step 20] Loss: 0.015
[Epoch 69, Step 20] Loss: 0.014
[Epoch 70, Step 20] Loss: 0.012
[Epoch 71, Step 20] Loss: 0.015
[Epoch 72, Step 20] Loss: 0.012
[Epoch 73, Step 20] Loss: 0.011
[Epoch 74, Step 20] Loss: 0.011
[Epoch 75, Step 20] Loss: 0.010
[Epoch 76, Step 20] Loss: 0.010
[Epoch 77, Step 20] Loss: 0.012
[Epoch 78, Step 20] Loss: 0.009
[Epoch 79, Step 20] Loss: 0.011
[Epoch 80, Step 20] Loss: 0.009
[Epoch 81, Step 20] Loss: 0.008
[Epoch 82, Step 20] Loss: 0.009
[Epoch 83, Step 20] Loss: 0.008
[Epoch 84, Step 20] Loss: 0.009
[Epoch 85, Step 20] Loss: 0.009
[Epoch 86, Step 20] Loss: 0.008
[Epoch 87, Step 20] Loss: 0.009
[Epoch 88, Step 20] Loss: 0.007
[Epoch 89, Step 20] Loss: 0.008
[Epoch 90, Step 20] Loss: 0.008
[Epoch 91, Step 20] Loss: 0.006
[Epoch 92, Step 20] Loss: 0.007
[Epoch 93, Step 20] Loss: 0.008
[Epoch 94, Step 20] Loss: 0.005
[Epoch 95, Step 20] Loss: 0.008
[Epoch 96, Step 20] Loss: 0.007
[Epoch 97, Step 20] Loss: 0.008
[Epoch 98, Step 20] Loss: 0.008
[Epoch 99, Step 20] Loss: 0.008
[Epoch 100, Step 20] Loss: 0.008

Finding best threshold:
Test Set (4505 images)


Threshold  | Acc      | Prec     | Rec      | F1
-------------------------------------------------------
0.01       | 0.4353   | 0.4017   | 0.9971   | 0.5727
0.03       | 0.5605   | 0.4632   | 0.9936   | 0.6318
0.05       | 0.6266   | 0.5042   | 0.9918   | 0.6685
0.07       | 0.6693   | 0.5347   | 0.9906   | 0.6945
0.09       | 0.6968   | 0.5565   | 0.9906   | 0.7127
0.11       | 0.7141   | 0.5713   | 0.9889   | 0.7242
0.13       | 0.7292   | 0.5847   | 0.9889   | 0.7349
0.15       | 0.7385   | 0.5935   | 0.9871   | 0.7413
0.17       | 0.7463   | 0.6009   | 0.9871   | 0.7471
0.19       | 0.7521   | 0.6065   | 0.9871   | 0.7514
0.21       | 0.7589   | 0.6135   | 0.9860   | 0.7564
0.23       | 0.7647   | 0.6197   | 0.9842   | 0.7605
0.25       | 0.7698   | 0.6251   | 0.9830   | 0.7643
0.27       | 0.7747   | 0.6304   | 0.9825   | 0.7680
0.29       | 0.7789   | 0.6350   | 0.9819   | 0.7712
0.31       | 0.7829   | 0.6395   | 0.9813   | 0.7743
0.33       | 0.7867   | 0.6438   | 0.9807   | 0.7773
0.35       | 0.7907   | 0.6482   | 0.9807   | 0.7805
0.37       | 0.7936   | 0.6518   | 0.9795   | 0.7827
0.39       | 0.7971   | 0.6558   | 0.9795   | 0.7856
0.41       | 0.8000   | 0.6594   | 0.9784   | 0.7879
0.43       | 0.8018   | 0.6617   | 0.9778   | 0.7892
0.45       | 0.8047   | 0.6653   | 0.9766   | 0.7915
0.47       | 0.8049   | 0.6665   | 0.9725   | 0.7910
0.49       | 0.8071   | 0.6694   | 0.9719   | 0.7927
0.51 (*)    | 0.8095   | 0.6725   | 0.9713   | 0.7947
0.53       | 0.8118   | 0.6753   | 0.9708   | 0.7965
0.55       | 0.8144   | 0.6791   | 0.9690   | 0.7986
0.57       | 0.8175   | 0.6838   | 0.9661   | 0.8008
0.59       | 0.8193   | 0.6864   | 0.9649   | 0.8021
0.61       | 0.8220   | 0.6901   | 0.9637   | 0.8043
0.63       | 0.8253   | 0.6950   | 0.9620   | 0.8070
0.65       | 0.8277   | 0.6986   | 0.9608   | 0.8090
0.67       | 0.8297   | 0.7019   | 0.9585   | 0.8104
0.69       | 0.8315   | 0.7049   | 0.9567   | 0.8117
0.71       | 0.8344   | 0.7092   | 0.9556   | 0.8142
0.73       | 0.8355   | 0.7115   | 0.9532   | 0.8148
0.75       | 0.8371   | 0.7148   | 0.9497   | 0.8157
0.77       | 0.8391   | 0.7182   | 0.9480   | 0.8172
0.79       | 0.8400   | 0.7209   | 0.9439   | 0.8174
0.81       | 0.8400   | 0.7235   | 0.9363   | 0.8162
0.83       | 0.8420   | 0.7281   | 0.9316   | 0.8173
0.85       | 0.8431   | 0.7312   | 0.9275   | 0.8177
0.87       | 0.8473   | 0.7388   | 0.9246   | 0.8213
0.89       | 0.8488   | 0.7442   | 0.9170   | 0.8216
0.91       | 0.8504   | 0.7502   | 0.9082   | 0.8217
0.93       | 0.8531   | 0.7589   | 0.8982   | 0.8227
0.95       | 0.8559   | 0.7714   | 0.8819   | 0.8229
-------------------------------------------------------
Default (0.50) row marked (*)
Optimal (best F1) threshold: 0.95 | F1: 0.8229

Optimal Threshold: 0.95

Evaluating model at best thershold:
Threshold: 0.95 | Acc: 0.8559 | Prec(+): 0.7714 | Rec(+): 0.8819 | F1(+): 0.8229 | F1-macro: 0.8507

Evaluating model at default threshold (0.5):
Threshold: 0.50 | Acc: 0.8078 | Prec(+): 0.6702 | Rec(+): 0.9719 | F1(+): 0.7933 | F1-macro: 0.8068