Total Trainable params: 22,597,058 / 22,597,058
CSWin Stage 1 Trainable params: 50,624
CSWin Stage 2 Trainable params: 399,104
CSWin Stage 3 Trainable params: 16,638,720
CSWin Stage 4 Trainable params: 3,157,504
Head Classifier Trainable params: 1,026
[Epoch 1, Step 20] Loss: 0.230
[Epoch 2, Step 20] Loss: 0.184
[Epoch 3, Step 20] Loss: 0.185
[Epoch 4, Step 20] Loss: 0.186
[Epoch 5, Step 20] Loss: 0.185
[Epoch 6, Step 20] Loss: 0.184
[Epoch 7, Step 20] Loss: 0.175
[Epoch 8, Step 20] Loss: 0.174
[Epoch 9, Step 20] Loss: 0.170
[Epoch 10, Step 20] Loss: 0.170
[Epoch 11, Step 20] Loss: 0.169
[Epoch 12, Step 20] Loss: 0.169
[Epoch 13, Step 20] Loss: 0.168
[Epoch 14, Step 20] Loss: 0.167
[Epoch 15, Step 20] Loss: 0.165
[Epoch 16, Step 20] Loss: 0.169
[Epoch 17, Step 20] Loss: 0.163
[Epoch 18, Step 20] Loss: 0.165
[Epoch 19, Step 20] Loss: 0.165
[Epoch 20, Step 20] Loss: 0.161
[Epoch 21, Step 20] Loss: 0.161
[Epoch 22, Step 20] Loss: 0.160
[Epoch 23, Step 20] Loss: 0.162
[Epoch 24, Step 20] Loss: 0.163
[Epoch 25, Step 20] Loss: 0.158
[Epoch 26, Step 20] Loss: 0.159
[Epoch 27, Step 20] Loss: 0.158
[Epoch 28, Step 20] Loss: 0.157
[Epoch 29, Step 20] Loss: 0.159
[Epoch 30, Step 20] Loss: 0.158
[Epoch 31, Step 20] Loss: 0.157
[Epoch 32, Step 20] Loss: 0.156
[Epoch 33, Step 20] Loss: 0.158
[Epoch 34, Step 20] Loss: 0.156
[Epoch 35, Step 20] Loss: 0.156
[Epoch 36, Step 20] Loss: 0.158
[Epoch 37, Step 20] Loss: 0.155
[Epoch 38, Step 20] Loss: 0.156
[Epoch 39, Step 20] Loss: 0.161
[Epoch 40, Step 20] Loss: 0.154
[Epoch 41, Step 20] Loss: 0.156
[Epoch 42, Step 20] Loss: 0.154
[Epoch 43, Step 20] Loss: 0.154
[Epoch 44, Step 20] Loss: 0.154
[Epoch 45, Step 20] Loss: 0.155
[Epoch 46, Step 20] Loss: 0.155
[Epoch 47, Step 20] Loss: 0.152
[Epoch 48, Step 20] Loss: 0.152
[Epoch 49, Step 20] Loss: 0.153
[Epoch 50, Step 20] Loss: 0.152
[Epoch 51, Step 20] Loss: 0.153
[Epoch 52, Step 20] Loss: 0.152
[Epoch 53, Step 20] Loss: 0.151
[Epoch 54, Step 20] Loss: 0.153
[Epoch 55, Step 20] Loss: 0.150
[Epoch 56, Step 20] Loss: 0.151
[Epoch 57, Step 20] Loss: 0.150
[Epoch 58, Step 20] Loss: 0.150
[Epoch 59, Step 20] Loss: 0.149
[Epoch 60, Step 20] Loss: 0.149
[Epoch 61, Step 20] Loss: 0.150
[Epoch 62, Step 20] Loss: 0.149
[Epoch 63, Step 20] Loss: 0.150
[Epoch 64, Step 20] Loss: 0.147
[Epoch 65, Step 20] Loss: 0.146
[Epoch 66, Step 20] Loss: 0.147
[Epoch 67, Step 20] Loss: 0.147
[Epoch 68, Step 20] Loss: 0.144
[Epoch 69, Step 20] Loss: 0.146
[Epoch 70, Step 20] Loss: 0.145
[Epoch 71, Step 20] Loss: 0.147
[Epoch 72, Step 20] Loss: 0.145
[Epoch 73, Step 20] Loss: 0.145
[Epoch 74, Step 20] Loss: 0.145
[Epoch 75, Step 20] Loss: 0.141
[Epoch 76, Step 20] Loss: 0.143
[Epoch 77, Step 20] Loss: 0.140
[Epoch 78, Step 20] Loss: 0.141
[Epoch 79, Step 20] Loss: 0.142
[Epoch 80, Step 20] Loss: 0.143
[Epoch 81, Step 20] Loss: 0.140
[Epoch 82, Step 20] Loss: 0.140
[Epoch 83, Step 20] Loss: 0.136
[Epoch 84, Step 20] Loss: 0.138
[Epoch 85, Step 20] Loss: 0.136
[Epoch 86, Step 20] Loss: 0.139
[Epoch 87, Step 20] Loss: 0.137
[Epoch 88, Step 20] Loss: 0.137
[Epoch 89, Step 20] Loss: 0.139
[Epoch 90, Step 20] Loss: 0.133
[Epoch 91, Step 20] Loss: 0.136
[Epoch 92, Step 20] Loss: 0.140
[Epoch 93, Step 20] Loss: 0.134
[Epoch 94, Step 20] Loss: 0.136
[Epoch 95, Step 20] Loss: 0.137
[Epoch 96, Step 20] Loss: 0.135
[Epoch 97, Step 20] Loss: 0.137
[Epoch 98, Step 20] Loss: 0.136
[Epoch 99, Step 20] Loss: 0.136
[Epoch 100, Step 20] Loss: 0.134

Finding best threshold:
Test Set (3157 images)


Threshold  | Acc      | Prec     | Rec      | F1
-------------------------------------------------------
0.01       | 0.6747   | 0.6747   | 1.0000   | 0.8057
0.03       | 0.6747   | 0.6747   | 1.0000   | 0.8057
0.05       | 0.6747   | 0.6747   | 1.0000   | 0.8057
0.07       | 0.6747   | 0.6747   | 1.0000   | 0.8057
0.09       | 0.6747   | 0.6747   | 1.0000   | 0.8057
0.11       | 0.6747   | 0.6747   | 1.0000   | 0.8057
0.13       | 0.6747   | 0.6747   | 1.0000   | 0.8057
0.15       | 0.6747   | 0.6747   | 1.0000   | 0.8057
0.17       | 0.6747   | 0.6748   | 0.9995   | 0.8057
0.19       | 0.6753   | 0.6752   | 0.9995   | 0.8060
0.21       | 0.6753   | 0.6757   | 0.9977   | 0.8057
0.23       | 0.6712   | 0.6752   | 0.9878   | 0.8021
0.25       | 0.6671   | 0.6750   | 0.9770   | 0.7984
0.27       | 0.6665   | 0.6796   | 0.9568   | 0.7947
0.29       | 0.6544   | 0.6796   | 0.9230   | 0.7828
0.31       | 0.6462   | 0.6847   | 0.8817   | 0.7708
0.33       | 0.6367   | 0.6942   | 0.8249   | 0.7539
0.35       | 0.6281   | 0.7057   | 0.7700   | 0.7364
0.37       | 0.6082   | 0.7135   | 0.7005   | 0.7069
0.39       | 0.5971   | 0.7324   | 0.6347   | 0.6801
0.41       | 0.5952   | 0.7572   | 0.5887   | 0.6624
0.43       | 0.5790   | 0.7795   | 0.5244   | 0.6270
0.45       | 0.5550   | 0.7926   | 0.4610   | 0.5830
0.47       | 0.5410   | 0.8144   | 0.4141   | 0.5490
0.49       | 0.5261   | 0.8344   | 0.3714   | 0.5140
0.51 (*)    | 0.5087   | 0.8526   | 0.3286   | 0.4744
0.53       | 0.4957   | 0.8789   | 0.2930   | 0.4394
0.55       | 0.4799   | 0.8923   | 0.2606   | 0.4033
0.57       | 0.4704   | 0.9194   | 0.2357   | 0.3752
0.59       | 0.4577   | 0.9409   | 0.2094   | 0.3425
0.61       | 0.4482   | 0.9533   | 0.1915   | 0.3190
0.63       | 0.4387   | 0.9711   | 0.1732   | 0.2940
0.65       | 0.4279   | 0.9682   | 0.1573   | 0.2706
0.67       | 0.4169   | 0.9769   | 0.1390   | 0.2433
0.69       | 0.4054   | 0.9810   | 0.1211   | 0.2156
0.71       | 0.3956   | 0.9784   | 0.1066   | 0.1922
0.73       | 0.3883   | 0.9807   | 0.0953   | 0.1737
0.75       | 0.3801   | 0.9943   | 0.0817   | 0.1510
0.77       | 0.3716   | 0.9932   | 0.0690   | 0.1291
0.79       | 0.3589   | 0.9907   | 0.0502   | 0.0956
0.81       | 0.3481   | 1.0000   | 0.0338   | 0.0654
0.83       | 0.3377   | 1.0000   | 0.0183   | 0.0360
0.85       | 0.3320   | 1.0000   | 0.0099   | 0.0195
0.87       | 0.3285   | 1.0000   | 0.0047   | 0.0093
0.89       | 0.3266   | 1.0000   | 0.0019   | 0.0037
0.91       | 0.3256   | 1.0000   | 0.0005   | 0.0009
0.93       | 0.3253   | 0.0000   | 0.0000   | 0.0000
0.95       | 0.3253   | 0.0000   | 0.0000   | 0.0000
-------------------------------------------------------
Default (0.50) row marked (*)
Optimal (best F1) threshold: 0.19 | F1: 0.8060

Optimal Threshold: 0.19

Evaluating model at best thershold:
Threshold: 0.19 | Acc: 0.6753 | Prec(+): 0.6752 | Rec(+): 0.9995 | F1(+): 0.8060 | F1-macro: 0.4059

Evaluating model at default threshold (0.5):
Threshold: 0.50 | Acc: 0.5211 | Prec(+): 0.8480 | Rec(+): 0.3535 | F1(+): 0.4990 | F1-macro: 0.5201