For mac gpu available:  False
For windows gpu available:  True
Using device: cuda
Total Trainable params: 24,440,066 / 24,440,066
ResNet50 params: 1,444,928
CSWin Stage 1 Trainable params: 50,624
CSWin Stage 2 Trainable params: 399,104
CSWin Stage 3 Trainable params: 16,638,720
CSWin Stage 4 Trainable params: 3,157,504
Head Classifier Trainable params: 1,026
Bridge Trainable params: 131,584
[Epoch 1, Step 20] Loss: 0.199
[Epoch 2, Step 20] Loss: 0.189
[Epoch 3, Step 20] Loss: 0.194
[Epoch 4, Step 20] Loss: 0.180
[Epoch 5, Step 20] Loss: 0.175
[Epoch 6, Step 20] Loss: 0.170
[Epoch 7, Step 20] Loss: 0.168
[Epoch 8, Step 20] Loss: 0.152
[Epoch 9, Step 20] Loss: 0.138
[Epoch 10, Step 20] Loss: 0.134
[Epoch 11, Step 20] Loss: 0.127
[Epoch 12, Step 20] Loss: 0.109
[Epoch 13, Step 20] Loss: 0.097
[Epoch 14, Step 20] Loss: 0.095
[Epoch 15, Step 20] Loss: 0.094
[Epoch 16, Step 20] Loss: 0.089
[Epoch 17, Step 20] Loss: 0.090
[Epoch 18, Step 20] Loss: 0.083
[Epoch 19, Step 20] Loss: 0.081
[Epoch 20, Step 20] Loss: 0.077
[Epoch 21, Step 20] Loss: 0.085
[Epoch 22, Step 20] Loss: 0.080
[Epoch 23, Step 20] Loss: 0.073
[Epoch 24, Step 20] Loss: 0.073
[Epoch 25, Step 20] Loss: 0.073
[Epoch 26, Step 20] Loss: 0.078
[Epoch 27, Step 20] Loss: 0.075
[Epoch 28, Step 20] Loss: 0.076
[Epoch 29, Step 20] Loss: 0.073
[Epoch 30, Step 20] Loss: 0.074
[Epoch 31, Step 20] Loss: 0.075
[Epoch 32, Step 20] Loss: 0.071
[Epoch 33, Step 20] Loss: 0.067
[Epoch 34, Step 20] Loss: 0.071
[Epoch 35, Step 20] Loss: 0.070
[Epoch 36, Step 20] Loss: 0.073
[Epoch 37, Step 20] Loss: 0.071
[Epoch 38, Step 20] Loss: 0.067
[Epoch 39, Step 20] Loss: 0.066
[Epoch 40, Step 20] Loss: 0.066
[Epoch 41, Step 20] Loss: 0.066
[Epoch 42, Step 20] Loss: 0.069
[Epoch 43, Step 20] Loss: 0.067
[Epoch 44, Step 20] Loss: 0.067
[Epoch 45, Step 20] Loss: 0.069
[Epoch 46, Step 20] Loss: 0.063
[Epoch 47, Step 20] Loss: 0.063
[Epoch 48, Step 20] Loss: 0.062
[Epoch 49, Step 20] Loss: 0.059
[Epoch 50, Step 20] Loss: 0.062
[Epoch 51, Step 20] Loss: 0.064
[Epoch 52, Step 20] Loss: 0.062
[Epoch 53, Step 20] Loss: 0.066
[Epoch 54, Step 20] Loss: 0.068
[Epoch 55, Step 20] Loss: 0.063
[Epoch 56, Step 20] Loss: 0.064
[Epoch 57, Step 20] Loss: 0.068
[Epoch 58, Step 20] Loss: 0.062
[Epoch 59, Step 20] Loss: 0.065
[Epoch 60, Step 20] Loss: 0.064
[Epoch 61, Step 20] Loss: 0.059
[Epoch 62, Step 20] Loss: 0.065
[Epoch 63, Step 20] Loss: 0.063
[Epoch 64, Step 20] Loss: 0.060
[Epoch 65, Step 20] Loss: 0.066
[Epoch 66, Step 20] Loss: 0.063
[Epoch 67, Step 20] Loss: 0.062
[Epoch 68, Step 20] Loss: 0.064
[Epoch 69, Step 20] Loss: 0.061
[Epoch 70, Step 20] Loss: 0.060
[Epoch 71, Step 20] Loss: 0.062
[Epoch 72, Step 20] Loss: 0.065
[Epoch 73, Step 20] Loss: 0.063
[Epoch 74, Step 20] Loss: 0.061
[Epoch 75, Step 20] Loss: 0.064
[Epoch 76, Step 20] Loss: 0.061
[Epoch 77, Step 20] Loss: 0.063
[Epoch 78, Step 20] Loss: 0.058
[Epoch 79, Step 20] Loss: 0.063
[Epoch 80, Step 20] Loss: 0.058
[Epoch 81, Step 20] Loss: 0.057
[Epoch 82, Step 20] Loss: 0.064
[Epoch 83, Step 20] Loss: 0.060
[Epoch 84, Step 20] Loss: 0.059
[Epoch 85, Step 20] Loss: 0.061
[Epoch 86, Step 20] Loss: 0.063
[Epoch 87, Step 20] Loss: 0.056
[Epoch 88, Step 20] Loss: 0.060
[Epoch 89, Step 20] Loss: 0.056
[Epoch 90, Step 20] Loss: 0.059
[Epoch 91, Step 20] Loss: 0.059
[Epoch 92, Step 20] Loss: 0.060
[Epoch 93, Step 20] Loss: 0.060
[Epoch 94, Step 20] Loss: 0.056
[Epoch 95, Step 20] Loss: 0.057
[Epoch 96, Step 20] Loss: 0.058
[Epoch 97, Step 20] Loss: 0.056
[Epoch 98, Step 20] Loss: 0.059
[Epoch 99, Step 20] Loss: 0.056
[Epoch 100, Step 20] Loss: 0.063

Finding best threshold:
Test Set (3157 images)


Threshold  | Acc      | Prec     | Rec      | F1
-------------------------------------------------------
0.01       | 0.6747   | 0.6747   | 1.0000   | 0.8057
0.03       | 0.6747   | 0.6747   | 1.0000   | 0.8057
0.05       | 0.6867   | 0.6829   | 1.0000   | 0.8116
0.07       | 0.7466   | 0.7270   | 1.0000   | 0.8419
0.09       | 0.8099   | 0.7806   | 0.9991   | 0.8764
0.11       | 0.8461   | 0.8174   | 0.9939   | 0.8970
0.13       | 0.8714   | 0.8476   | 0.9869   | 0.9119
0.15       | 0.8917   | 0.8769   | 0.9765   | 0.9240
0.17       | 0.9050   | 0.9003   | 0.9662   | 0.9321
0.19       | 0.9069   | 0.9128   | 0.9531   | 0.9325
0.21       | 0.9021   | 0.9182   | 0.9385   | 0.9283
0.23       | 0.9002   | 0.9251   | 0.9272   | 0.9261
0.25       | 0.8936   | 0.9317   | 0.9089   | 0.9202
0.27       | 0.8857   | 0.9372   | 0.8901   | 0.9131
0.29       | 0.8796   | 0.9433   | 0.8742   | 0.9074
0.31       | 0.8758   | 0.9507   | 0.8606   | 0.9034
0.33       | 0.8651   | 0.9556   | 0.8390   | 0.8935
0.35       | 0.8559   | 0.9619   | 0.8188   | 0.8846
0.37       | 0.8454   | 0.9670   | 0.7981   | 0.8745
0.39       | 0.8331   | 0.9706   | 0.7761   | 0.8625
0.41       | 0.8258   | 0.9771   | 0.7596   | 0.8547
0.43       | 0.8115   | 0.9800   | 0.7357   | 0.8404
0.45       | 0.7954   | 0.9824   | 0.7094   | 0.8239
0.47       | 0.7742   | 0.9836   | 0.6765   | 0.8017
0.49       | 0.7517   | 0.9828   | 0.6432   | 0.7775
0.51 (*)    | 0.7308   | 0.9841   | 0.6108   | 0.7538
0.53       | 0.7083   | 0.9832   | 0.5775   | 0.7276
0.55       | 0.6855   | 0.9855   | 0.5418   | 0.6992
0.57       | 0.6614   | 0.9863   | 0.5052   | 0.6681
0.59       | 0.6405   | 0.9863   | 0.4737   | 0.6400
0.61       | 0.6142   | 0.9882   | 0.4333   | 0.6025
0.63       | 0.5917   | 0.9895   | 0.3991   | 0.5688
0.65       | 0.5654   | 0.9909   | 0.3592   | 0.5272
0.67       | 0.5353   | 0.9911   | 0.3141   | 0.4770
0.69       | 0.5128   | 0.9901   | 0.2808   | 0.4375
0.71       | 0.4919   | 0.9944   | 0.2484   | 0.3974
0.73       | 0.4678   | 0.9934   | 0.2127   | 0.3503
0.75       | 0.4463   | 0.9974   | 0.1798   | 0.3047
0.77       | 0.4257   | 1.0000   | 0.1488   | 0.2591
0.79       | 0.4089   | 1.0000   | 0.1239   | 0.2206
0.81       | 0.3991   | 1.0000   | 0.1094   | 0.1972
0.83       | 0.3890   | 1.0000   | 0.0944   | 0.1725
0.85       | 0.3766   | 1.0000   | 0.0761   | 0.1414
0.87       | 0.3659   | 1.0000   | 0.0601   | 0.1134
0.89       | 0.3551   | 1.0000   | 0.0441   | 0.0845
0.91       | 0.3449   | 1.0000   | 0.0291   | 0.0566
0.93       | 0.3342   | 1.0000   | 0.0131   | 0.0259
0.95       | 0.3269   | 1.0000   | 0.0023   | 0.0047
-------------------------------------------------------
Default (0.50) row marked (*)
Optimal (best F1) threshold: 0.19 | F1: 0.9325

Optimal Threshold: 0.19

Evaluating model at best thershold:
Threshold: 0.19 | Acc: 0.9069 | Prec(+): 0.9128 | Rec(+): 0.9531 | F1(+): 0.9325 | F1-macro: 0.8912

Evaluating model at default threshold (0.5):
Threshold: 0.50 | Acc: 0.7425 | Prec(+): 0.9845 | Rec(+): 0.6282 | F1(+): 0.7670 | F1-macro: 0.7396