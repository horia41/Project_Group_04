Total Trainable params: 24,440,066 / 24,440,066
ResNet50 params: 1,444,928
CSWin Stage 1 Trainable params: 50,624
CSWin Stage 2 Trainable params: 399,104
CSWin Stage 3 Trainable params: 16,638,720
CSWin Stage 4 Trainable params: 3,157,504
Head Classifier Trainable params: 1,026
Bridge Trainable params: 131,584
[Epoch 1, Step 20] Loss: 0.194
[Epoch 2, Step 20] Loss: 0.183
[Epoch 3, Step 20] Loss: 0.174
[Epoch 4, Step 20] Loss: 0.169
[Epoch 5, Step 20] Loss: 0.166
[Epoch 6, Step 20] Loss: 0.168
[Epoch 7, Step 20] Loss: 0.161
[Epoch 8, Step 20] Loss: 0.163
[Epoch 9, Step 20] Loss: 0.153
[Epoch 10, Step 20] Loss: 0.152
[Epoch 11, Step 20] Loss: 0.149
[Epoch 12, Step 20] Loss: 0.146
[Epoch 13, Step 20] Loss: 0.124
[Epoch 14, Step 20] Loss: 0.114
[Epoch 15, Step 20] Loss: 0.093
[Epoch 16, Step 20] Loss: 0.090
[Epoch 17, Step 20] Loss: 0.084
[Epoch 18, Step 20] Loss: 0.078
[Epoch 19, Step 20] Loss: 0.078
[Epoch 20, Step 20] Loss: 0.076
[Epoch 21, Step 20] Loss: 0.081
[Epoch 22, Step 20] Loss: 0.068
[Epoch 23, Step 20] Loss: 0.070
[Epoch 24, Step 20] Loss: 0.071
[Epoch 25, Step 20] Loss: 0.071
[Epoch 26, Step 20] Loss: 0.068
[Epoch 27, Step 20] Loss: 0.066
[Epoch 28, Step 20] Loss: 0.065
[Epoch 29, Step 20] Loss: 0.068
[Epoch 30, Step 20] Loss: 0.066
[Epoch 31, Step 20] Loss: 0.063
[Epoch 32, Step 20] Loss: 0.064
[Epoch 33, Step 20] Loss: 0.063
[Epoch 34, Step 20] Loss: 0.065
[Epoch 35, Step 20] Loss: 0.061
[Epoch 36, Step 20] Loss: 0.061
[Epoch 37, Step 20] Loss: 0.059
[Epoch 38, Step 20] Loss: 0.061
[Epoch 39, Step 20] Loss: 0.059
[Epoch 40, Step 20] Loss: 0.058
[Epoch 41, Step 20] Loss: 0.063
[Epoch 42, Step 20] Loss: 0.058
[Epoch 43, Step 20] Loss: 0.058
[Epoch 44, Step 20] Loss: 0.055
[Epoch 45, Step 20] Loss: 0.054
[Epoch 46, Step 20] Loss: 0.055
[Epoch 47, Step 20] Loss: 0.057
[Epoch 48, Step 20] Loss: 0.052
[Epoch 49, Step 20] Loss: 0.050
[Epoch 50, Step 20] Loss: 0.055
[Epoch 51, Step 20] Loss: 0.052
[Epoch 52, Step 20] Loss: 0.053
[Epoch 53, Step 20] Loss: 0.054
[Epoch 54, Step 20] Loss: 0.057
[Epoch 55, Step 20] Loss: 0.054
[Epoch 56, Step 20] Loss: 0.052
[Epoch 57, Step 20] Loss: 0.051
[Epoch 58, Step 20] Loss: 0.052
[Epoch 59, Step 20] Loss: 0.052
[Epoch 60, Step 20] Loss: 0.046
[Epoch 61, Step 20] Loss: 0.052
[Epoch 62, Step 20] Loss: 0.052
[Epoch 63, Step 20] Loss: 0.050
[Epoch 64, Step 20] Loss: 0.052
[Epoch 65, Step 20] Loss: 0.053
[Epoch 66, Step 20] Loss: 0.053
[Epoch 67, Step 20] Loss: 0.048
[Epoch 68, Step 20] Loss: 0.049
[Epoch 69, Step 20] Loss: 0.048
[Epoch 70, Step 20] Loss: 0.049
[Epoch 71, Step 20] Loss: 0.052
[Epoch 72, Step 20] Loss: 0.048
[Epoch 73, Step 20] Loss: 0.053
[Epoch 74, Step 20] Loss: 0.053
[Epoch 75, Step 20] Loss: 0.050
[Epoch 76, Step 20] Loss: 0.047
[Epoch 77, Step 20] Loss: 0.050
[Epoch 78, Step 20] Loss: 0.050
[Epoch 79, Step 20] Loss: 0.048
[Epoch 80, Step 20] Loss: 0.044
[Epoch 81, Step 20] Loss: 0.045
[Epoch 82, Step 20] Loss: 0.051
[Epoch 83, Step 20] Loss: 0.046
[Epoch 84, Step 20] Loss: 0.051
[Epoch 85, Step 20] Loss: 0.045
[Epoch 86, Step 20] Loss: 0.041
[Epoch 87, Step 20] Loss: 0.044
[Epoch 88, Step 20] Loss: 0.047
[Epoch 89, Step 20] Loss: 0.045
[Epoch 90, Step 20] Loss: 0.049
[Epoch 91, Step 20] Loss: 0.047
[Epoch 92, Step 20] Loss: 0.047
[Epoch 93, Step 20] Loss: 0.042
[Epoch 94, Step 20] Loss: 0.048
[Epoch 95, Step 20] Loss: 0.047
[Epoch 96, Step 20] Loss: 0.047
[Epoch 97, Step 20] Loss: 0.047
[Epoch 98, Step 20] Loss: 0.045
[Epoch 99, Step 20] Loss: 0.045
[Epoch 100, Step 20] Loss: 0.047

Finding best threshold:
Test Set (4505 images)


Threshold  | Acc      | Prec     | Rec      | F1
-------------------------------------------------------
0.01       | 0.3796   | 0.3796   | 1.0000   | 0.5503
0.03       | 0.3796   | 0.3796   | 1.0000   | 0.5503
0.05       | 0.3831   | 0.3809   | 1.0000   | 0.5517
0.07       | 0.4391   | 0.4036   | 1.0000   | 0.5751
0.09       | 0.5270   | 0.4452   | 1.0000   | 0.6161
0.11       | 0.5971   | 0.4851   | 0.9994   | 0.6532
0.13       | 0.6484   | 0.5191   | 0.9988   | 0.6832
0.15       | 0.6881   | 0.5491   | 0.9982   | 0.7084
0.17       | 0.7145   | 0.5710   | 0.9965   | 0.7260
0.19       | 0.7365   | 0.5907   | 0.9959   | 0.7416
0.21       | 0.7565   | 0.6098   | 0.9953   | 0.7563
0.23       | 0.7669   | 0.6208   | 0.9918   | 0.7636
0.25       | 0.7765   | 0.6309   | 0.9906   | 0.7709
0.27       | 0.7867   | 0.6421   | 0.9895   | 0.7788
0.29       | 0.7973   | 0.6549   | 0.9854   | 0.7868
0.31       | 0.8073   | 0.6669   | 0.9836   | 0.7949
0.33       | 0.8151   | 0.6770   | 0.9807   | 0.8011
0.35       | 0.8233   | 0.6879   | 0.9784   | 0.8078
0.37       | 0.8324   | 0.7005   | 0.9754   | 0.8154
0.39       | 0.8395   | 0.7113   | 0.9713   | 0.8213
0.41       | 0.8455   | 0.7222   | 0.9637   | 0.8257
0.43       | 0.8511   | 0.7312   | 0.9608   | 0.8304
0.45       | 0.8559   | 0.7408   | 0.9544   | 0.8341
0.47       | 0.8606   | 0.7509   | 0.9468   | 0.8376
0.49       | 0.8673   | 0.7635   | 0.9421   | 0.8435
0.51 (*)    | 0.8684   | 0.7692   | 0.9333   | 0.8433
0.53       | 0.8713   | 0.7764   | 0.9281   | 0.8455
0.55       | 0.8737   | 0.7865   | 0.9158   | 0.8463
0.57       | 0.8786   | 0.7987   | 0.9094   | 0.8504
0.59       | 0.8788   | 0.8050   | 0.8982   | 0.8491
0.61       | 0.8792   | 0.8118   | 0.8877   | 0.8480
0.63       | 0.8806   | 0.8195   | 0.8789   | 0.8482
0.65       | 0.8806   | 0.8274   | 0.8661   | 0.8463
0.67       | 0.8790   | 0.8342   | 0.8503   | 0.8422
0.69       | 0.8772   | 0.8401   | 0.8357   | 0.8379
0.71       | 0.8726   | 0.8451   | 0.8135   | 0.8290
0.73       | 0.8664   | 0.8493   | 0.7877   | 0.8174
0.75       | 0.8628   | 0.8550   | 0.7690   | 0.8097
0.77       | 0.8553   | 0.8633   | 0.7351   | 0.7941
0.79       | 0.8453   | 0.8705   | 0.6959   | 0.7735
0.81       | 0.8342   | 0.8812   | 0.6509   | 0.7487
0.83       | 0.8164   | 0.8904   | 0.5889   | 0.7089
0.85       | 0.7933   | 0.8922   | 0.5181   | 0.6556
0.87       | 0.7718   | 0.9099   | 0.4427   | 0.5956
0.89       | 0.7476   | 0.9207   | 0.3667   | 0.5245
0.91       | 0.7225   | 0.9182   | 0.2953   | 0.4469
0.93       | 0.7041   | 0.9255   | 0.2398   | 0.3809
0.95       | 0.6721   | 0.9299   | 0.1474   | 0.2544
-------------------------------------------------------
Default (0.50) row marked (*)
Optimal (best F1) threshold: 0.57 | F1: 0.8504

Optimal Threshold: 0.57

Evaluating model at best thershold:
Threshold: 0.57 | Acc: 0.8786 | Prec(+): 0.7987 | Rec(+): 0.9094 | F1(+): 0.8504 | F1-macro: 0.8741

Evaluating model at default threshold (0.5):
Threshold: 0.50 | Acc: 0.8681 | Prec(+): 0.7665 | Rec(+): 0.9386 | F1(+): 0.8438 | F1-macro: 0.8649